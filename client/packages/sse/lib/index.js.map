{"version":3,"sources":["marble-sse-element.ts"],"names":[],"mappings":"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","file":"index.js","sourceRoot":"..","sourcesContent":["/** Simple Quick & Dirty marble visualizer, POJS no framework */\n\n//const noneFilledShapes  = ['□', '△', '○', '▷', '☆'];\n//const filledShapes      = ['■', '▲', '●', '▶', '★'];\n\nconst URL_ATTR     = 'sse-url';\n\nexport class RXMarbleSSEElement extends HTMLElement {\n\n    // private subscription:Subscription;\n    private eventSource:EventSource;\n\n    get url() {\n        return this.getAttribute(URL_ATTR) || \"events\";\n    }\n\n    set url( v:string ) {\n       this.setAttribute(URL_ATTR, v );\n    }\n\n    static get observedAttributes():Array<string> { return []; }\n\n    constructor() {\n        super();\n    }\n\n    private dispatchMessage( data:any ) {\n        window.dispatchEvent( new CustomEvent('rxmarbles.event', { detail: data } ) );\n    }\n\n    connectedCallback () {\n        this.eventSource = new EventSource( this.url, { withCredentials: false } );\n    \n        this.eventSource.onmessage = e => this.dispatchMessage( JSON.parse(e.data) );\n    \n        this.eventSource.onerror = (e:any) => this.dispatchMessage(  new Error(e.data) );\n\n        // const evtSource = Observable.create( (observer:Observer<any>) => {\n        //     const evtSource  = new EventSource( this.url, { withCredentials: false } );\n    \n        //     evtSource.onmessage = e => observer.next( JSON.parse(e.data) );\n    \n        //     evtSource.onerror = (e:any) => observer.next( new Error(e.data) );\n    \n        //     return () => evtSource.close();\n        // });\n\n        // this.subscription = \n        //     evtSource\n        //         .pipe( tap( \n        //             (e:any) => console.log( \"sse event\", e ),\n        //             (e:any) => console.log( \"sse error\", e ) ))\n        //         .subscribe(\n        //             (event:any) => window.dispatchEvent( new CustomEvent('rxmarbles.event', { detail: event } )) \n        //         );\n\n    }\n\n    disconnectedCallback() {\n\n        if( this.eventSource ) {\n            this.eventSource.close();\n        }\n\n        // if(this.subscription && !this.subscription.closed) {\n        //     this.subscription.unsubscribe();\n        // } \n\n    }\n\n    attributesChangedCallback(attribute:string, oldval:any, newval:any) {\n\n        console.log( \"update ${attribute}\", oldval, newval );\n    }\n\n}\n\ntry {\n\n    customElements.define('rxmarble-sse', RXMarbleSSEElement);\n\n} catch (err) {\n    console.error( err );\n}\n    \n\n\n"]}